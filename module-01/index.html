<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"/>

        <title>HTML5 Template</title>

        <style>
            body,
            #map {
                position: absolute;
                width: 100%;
                top: 0;
                bottom: 0;
            }
        </style>
    </head>

    <body>
        <div id="map"></div>

        <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
        <script src="https://d3js.org/d3.v5.min.js"></script>

        <script>
            const options = {
                center: [33.726, -84.365],
                zoom: 9,
                minZoom: 9,
                maxZoom: 16,
                maxBounds: [[33.911, -84.032], [33.62, -84.772]]
            };

            const map = L.map("map", options);

            L.tileLayer(
                "https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",
                {
                    attribution:
                        '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
                    subdomains: "abcd",
                    maxZoom: 19
                }
            ).addTo(map);

            // deferred requests for all the data files
            const urbanAreasJson = d3.json('data/urban-areas.json');
            const cityLimitsJson = d3.json('data/city-limits.json');
            const neighborhoodsJson = d3.json('data/neighborhoods.json');
            const transitRoutesJson = d3.json('data/transit-routes.json');

            function drawMap(json) {
                L.geoJson(json).addTo(map);
            }


            // when they're all loaded and available, send data to drawMap function
            Promise.all([urbanAreasJson, cityLimitsJson, neighborhoodsJson, transitRoutesJson]).then(drawMap);
        </script>
    </body>
</html>
